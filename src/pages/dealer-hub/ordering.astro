---
import DealerHubLayout from '../../layouts/DealerHubLayout.astro';
---
<DealerHubLayout title="Ordering SOPs | Pinnacle Sales Dealer Hub" activeSection="Ordering SOPs">

<h1>Ordering Standard Operating Procedures</h1>
<p class="page-subtitle">Step-by-step process from project quote to delivery for every Pinnacle Sales brand.</p>

<h2>Shiloh / Eclipse / Aspect — WW Wood Products</h2>

<ol class="step-list">
  <li><strong>Design & Specification</strong> — Create the project in 20/20 Design or ProKitchen using the appropriate Shiloh, Eclipse, or Aspect catalog. Verify door style, finish, wood species, modifications, and accessories. Export a preliminary quote for client review.</li>
  <li><strong>Complete the Cover Sheet & Standard Order Form</strong> — Every order requires a completed cover sheet and the correct standard order form for your brand. Download the appropriate form below and watch the walkthrough video to see how to fill it out correctly.
    <div class="custom-quote-resources">
      <a href="/downloads/standard-order-form-shiloh.pdf" class="download-btn" download>Shiloh Order Form (PDF)</a>
      <a href="/downloads/standard-order-form-eclipse.pdf" class="download-btn" download>Eclipse Order Form (PDF)</a>
      <a href="/downloads/standard-order-form-aspect.pdf" class="download-btn" download>Aspect Order Form (PDF)</a>
    </div>
    <div class="video-embed">
      <video controls preload="metadata" playsinline>
        <source src="/videos/how-to-fill-out-shiloh-cabinetry-cover-sheet.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
      <p class="video-caption">How to Fill Out the Shiloh Cabinetry Cover Sheet</p>
    </div>
  </li>
  <li><strong>Custom Quotes</strong> — For any items requiring custom pricing — such as non-standard sizes, special modifications, or unique configurations — please fill out our Custom Quote Worksheet and email the completed form to Billy Rhea at <a href="mailto:quotes@wwinc.com">quotes@wwinc.com</a>. Download the form below, and watch the walkthrough video to learn how to complete it.
    <div class="custom-quote-resources">
      <a href="/downloads/custom-quote-worksheet-form.pdf" class="download-btn" download>Download Custom Quote Worksheet (PDF)</a>
    </div>
    <div class="video-embed">
      <video controls preload="metadata" playsinline>
        <source src="/videos/custom-quote-worksheet-overview.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
      <p class="video-caption">Custom Quote Worksheet Overview for Shiloh and Eclipse Cabinetry</p>
    </div>
  </li>
  <li><strong>Appliance Specs &amp; Cutout Sheets</strong> — If the project includes built-in appliances, you'll need to submit the correct appliance cutout specification forms and panel dimensions with your order. Download the appropriate cutout sheets for your brand below. Watch the walkthrough videos to learn how to spec appliance cutouts and appliance panels correctly.
    <p class="brand-label"><strong>Aspect Cut Sheets</strong></p>
    <div class="custom-quote-resources">
      <a href="/downloads/oven-cutout-spec-aspect.pdf" class="download-btn" download>Oven Cutout</a>
      <a href="/downloads/oven-microwave-cutout-spec-aspect.pdf" class="download-btn" download>Oven/Microwave Cutout</a>
      <a href="/downloads/base-oven-cutout-spec-aspect.pdf" class="download-btn" download>Base Oven Cutout</a>
      <a href="/downloads/base-warming-drawer-cutout-spec-aspect.pdf" class="download-btn" download>Base Warming Drawer</a>
    </div>
    <p class="brand-label"><strong>Shiloh Cut Sheets</strong></p>
    <div class="custom-quote-resources">
      <a href="/downloads/oven-cutout-spec-shiloh.pdf" class="download-btn" download>Oven Cutout</a>
      <a href="/downloads/oven-microwave-cutout-spec-shiloh.pdf" class="download-btn" download>Oven/Microwave Cutout</a>
      <a href="/downloads/base-oven-cutout-spec-shiloh.pdf" class="download-btn" download>Base Oven Cutout</a>
      <a href="/downloads/base-warming-drawer-cutout-spec-shiloh.pdf" class="download-btn" download>Base Warming Drawer</a>
      <a href="/downloads/wall-microwave-cutout-spec-shiloh.pdf" class="download-btn" download>Wall Microwave Cutout</a>
      <a href="/downloads/wall-microwave-custom-cutout-spec-shiloh.pdf" class="download-btn" download>Wall Microwave Custom</a>
    </div>
    <div class="custom-quote-resources">
      <a href="/downloads/flush-inset-oven-cutout-spec-shiloh.pdf" class="download-btn" download>Flush Inset Oven</a>
      <a href="/downloads/flush-inset-oven-microwave-cutout-spec-shiloh.pdf" class="download-btn" download>Flush Inset Oven/Microwave</a>
      <a href="/downloads/flush-inset-base-oven-cutout-spec-shiloh.pdf" class="download-btn" download>Flush Inset Base Oven</a>
      <a href="/downloads/flush-inset-base-warming-drawer-cutout-spec-shiloh.pdf" class="download-btn" download>Flush Inset Base Warming Drawer</a>
    </div>
    <p class="brand-label"><strong>Eclipse Cut Sheets</strong></p>
    <div class="custom-quote-resources">
      <a href="/downloads/oven-cutout-spec-eclipse.pdf" class="download-btn" download>Oven Cutout</a>
      <a href="/downloads/oven-microwave-cutout-spec-eclipse.pdf" class="download-btn" download>Oven/Microwave Cutout</a>
      <a href="/downloads/base-oven-cutout-spec-eclipse.pdf" class="download-btn" download>Base Oven Cutout</a>
      <a href="/downloads/base-warming-drawer-cutout-spec-eclipse.pdf" class="download-btn" download>Base Warming Drawer</a>
      <a href="/downloads/wall-microwave-custom-cutout-spec-eclipse.pdf" class="download-btn" download>Wall Microwave Custom</a>
    </div>
    <div class="custom-quote-resources">
      <a href="/downloads/flush-inset-oven-cutout-spec-eclipse.pdf" class="download-btn" download>Flush Inset Oven</a>
      <a href="/downloads/flush-inset-oven-microwave-cutout-spec-eclipse.pdf" class="download-btn" download>Flush Inset Oven/Microwave</a>
      <a href="/downloads/flush-inset-base-oven-cutout-spec-eclipse.pdf" class="download-btn" download>Flush Inset Base Oven</a>
      <a href="/downloads/flush-inset-base-warming-drawer-cutout-spec-eclipse.pdf" class="download-btn" download>Flush Inset Base Warming Drawer</a>
    </div>
    <div class="video-embed">
      <video controls preload="metadata" playsinline>
        <source src="/videos/appliance-cutouts.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
      <p class="video-caption">How to Spec Appliance Cutouts</p>
    </div>
    <div class="video-embed">
      <video controls preload="metadata" playsinline>
        <source src="/videos/appliance-panels.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
      <p class="video-caption">How to Spec Appliance Panels</p>
    </div>
  </li>
  <li><strong>Pre-Order Review (First 3-4 Projects)</strong> — For your first 3-4 projects, email the 20/20 / ProKitchen project file to your Pinnacle Sales rep for a full review before ordering. We check for spec errors, pricing optimization, modification feasibility, and lead-time items that could delay delivery. After that, you're cleared to order on your own — with design reviews by Pinnacle Sales available anytime you need a second set of eyes.</li>
  <li><strong>Submit Order to WW Wood</strong> — Once the client approves, submit the order through the WW Wood online ordering portal. Include PO number, ship-to address, and any special instructions.</li>
  <li><strong>Order Acknowledgment (1 Business Day to Review)</strong> — WW Wood sends an order acknowledgment confirming specs, pricing, and estimated ship date. You have 1 business day to review and flag any changes or error corrections. Mark corrections directly on the acknowledgment and resend to <a href="mailto:orders@wwinc.com">orders@wwinc.com</a>. Do not consider the order final until you receive a revised acknowledgment reflecting your changes. Changes after this window may incur charges or reset lead time.</li>
  <li><strong>Production & Tracking</strong> — Standard lead time is approximately 6 weeks from order acknowledgment for Shiloh, Eclipse, Aspect, and Nevara. Track your order status through the WW Wood portal, check your delivery acknowledgment, or email <a href="mailto:customer.service@wwinc.com">customer.service@wwinc.com</a> with your order number for a delivery ETA.
    <div class="video-embed">
      <video controls preload="metadata" playsinline>
        <source src="/videos/lead-times.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
      <p class="video-caption">Understanding Lead Times for Standard Orders from WW Wood</p>
    </div>
  </li>
  <li><strong>Delivery Inspection</strong> — Inspect all cabinets upon delivery. Note any damage on the carrier's bill of lading before signing. Report damage or missing items to WW Wood customer service within 5 business days. Contact Pinnacle Sales if you need help with a claim. If you need to submit a warranty request, download the correct form for your brand below and watch the walkthrough video to learn how to fill it out.
    <div class="custom-quote-resources">
      <a href="/downloads/warranty-request-form-shiloh.pdf" class="download-btn" download>Shiloh Warranty Form</a>
      <a href="/downloads/warranty-request-form-eclipse.pdf" class="download-btn" download>Eclipse Warranty Form</a>
      <a href="/downloads/warranty-request-form-aspect.pdf" class="download-btn" download>Aspect Warranty Form</a>
    </div>
    <div class="video-embed">
      <video controls preload="metadata" playsinline>
        <source src="/videos/warranty-request-form-review.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
      <p class="video-caption">How to Order Warranty Items</p>
    </div>
  </li>
</ol>

<div class="featured-tool">
  <div class="featured-tool-header">
    <span class="tool-badge">INTERACTIVE TOOL</span>
    <h2 style="margin-top:0.5rem;">Order Form Selector</h2>
    <p>Not sure which order form to use? Answer a few quick questions about your order — cabinets, express shipping, outsourced items, samples, and loose doors — and this tool will tell you exactly which form you need.</p>
  </div>
  <div id="order-form-selector"></div>
</div>

<h2>Pronorm German Kitchens</h2>
<p>For all Pronorm ordering, design, and specification information, visit <a href="https://pronormusa.com" target="_blank" rel="noopener">PronormUSA.com</a>.</p>

<h2>Key Contacts for Order Issues</h2>
<p>See the full <a href="/dealer-hub/support">Support & Escalation Map</a> for detailed routing, or <a href="/dealer-hub/submit">submit a design or order for review</a>.</p>

<div class="card-grid">
  <div class="hub-card">
    <h3>WW Wood Customer Service</h3>
    <p>Order status, changes, delivery issues<br>573-624-7090</p>
  </div>
  <div class="hub-card">
    <h3>Pinnacle Sales</h3>
    <p>Pre-order review, pricing, specifications<br>480-993-9224</p>
  </div>
</div>

</DealerHubLayout>
<style is:global>
  .video-embed {
    margin: 1rem 0 0.5rem;
  }
  .video-embed video {
    width: 100%;
    max-width: 640px;
    border-radius: 8px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.1);
  }
  .video-caption {
    font-size: 0.85rem;
    color: #666;
    margin-top: 0.4rem;
    font-style: italic;
  }
  .custom-quote-resources {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.5rem;
    margin: 1rem 0;
  }
  .download-btn {
    display: inline-flex;
    align-items: center;
    padding: 0.6rem 1.2rem;
    background: #1a1a1a;
    color: #fff;
    text-decoration: none;
    border-radius: 6px;
    font-size: 0.9rem;
    font-weight: 500;
    transition: background 0.2s ease;
  }
  .download-btn:hover {
    background: #333;
  }
  .brand-label {
    margin: 1rem 0 0.25rem;
    font-size: 0.95rem;
    color: #333;
  }
  .featured-tool {
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: 1.75rem;
    margin: 2rem 0 2.5rem;
  }
  .featured-tool-header {
    margin-bottom: 1.25rem;
  }
  .tool-badge {
    display: inline-block;
    font-size: 0.65rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--color-muted);
    background: var(--color-bg-alt);
    border: 1px solid var(--color-border);
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
  }
  #order-form-selector {
    font-family: var(--font-body);
  }
  .ofs-progress-bar {
    width: 100%;
    margin-bottom: 1.25rem;
  }
  .ofs-progress-meta {
    display: flex;
    justify-content: space-between;
    font-size: 0.8rem;
    color: var(--color-muted);
    margin-bottom: 0.4rem;
  }
  .ofs-progress-track {
    height: 4px;
    border-radius: 10px;
    background: var(--color-border);
    overflow: hidden;
  }
  .ofs-progress-fill {
    height: 100%;
    border-radius: 10px;
    background: var(--color-dark);
    transition: width 0.5s ease;
  }
  .ofs-progress-fill.complete {
    background: #0B6E4F;
  }
  .ofs-breadcrumbs {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 1.25rem;
  }
  .ofs-crumb {
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .ofs-crumb-pill {
    padding: 2px 10px;
    border-radius: 20px;
    font-weight: 600;
    font-size: 0.68rem;
    letter-spacing: 0.03em;
    text-transform: uppercase;
  }
  .ofs-crumb-pill.yes {
    background: #D1FAE5;
    color: #065F46;
  }
  .ofs-crumb-pill.no {
    background: #FEE2E2;
    color: #991B1B;
  }
  .ofs-crumb-arrow {
    color: #C4C6CC;
    font-size: 0.75rem;
  }
  .ofs-question-card {
    opacity: 0;
    transform: translateY(16px);
    transition: all 0.4s ease;
  }
  .ofs-question-card.visible {
    opacity: 1;
    transform: translateY(0);
  }
  .ofs-icon {
    font-size: 2.5rem;
    margin-bottom: 0.75rem;
    line-height: 1;
  }
  .ofs-question {
    font-size: 1.15rem;
    font-weight: 600;
    color: var(--color-black);
    margin: 0 0 0.5rem;
    line-height: 1.3;
  }
  .ofs-subtitle {
    font-size: 0.9rem;
    color: var(--color-muted);
    margin: 0 0 1.5rem;
    line-height: 1.6;
  }
  .ofs-buttons {
    display: flex;
    gap: 0.75rem;
  }
  .ofs-btn {
    font-family: var(--font-body);
    font-size: 0.9rem;
    font-weight: 600;
    padding: 0.7rem 2rem;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    transition: all 0.15s;
    letter-spacing: 0.01em;
  }
  .ofs-btn-yes {
    background: var(--color-dark);
    color: #fff;
    box-shadow: 0 2px 8px rgba(26,29,35,0.15);
  }
  .ofs-btn-yes:hover { background: #333; }
  .ofs-btn-no {
    background: #F3F4F6;
    color: var(--color-dark);
  }
  .ofs-btn-no:hover { background: #E5E7EB; }
  .ofs-result-card {
    opacity: 0;
    transform: scale(0.97);
    transition: all 0.5s ease;
    border-radius: 14px;
    padding: 2rem 1.75rem;
    color: #fff;
    box-shadow: 0 16px 48px rgba(0,0,0,0.12);
  }
  .ofs-result-card.visible {
    opacity: 1;
    transform: scale(1);
  }
  .ofs-result-badge {
    display: inline-block;
    background: rgba(255,255,255,0.2);
    border-radius: 8px;
    padding: 4px 12px;
    font-size: 0.68rem;
    font-weight: 700;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    margin-bottom: 1rem;
  }
  .ofs-result-icon {
    font-size: 2rem;
    margin-bottom: 0.75rem;
  }
  .ofs-result-form {
    font-size: 1.3rem;
    font-weight: 700;
    margin: 0 0 0.4rem;
    line-height: 1.25;
  }
  .ofs-result-part {
    font-size: 0.9rem;
    opacity: 0.85;
    margin-bottom: 1rem;
    font-family: monospace;
    letter-spacing: 0.02em;
  }
  .ofs-result-notes {
    background: rgba(255,255,255,0.15);
    border-radius: 10px;
    padding: 0.75rem 1rem;
    font-size: 0.85rem;
    line-height: 1.6;
  }
  .ofs-reset-btn {
    margin-top: 1rem;
    width: 100%;
    font-family: var(--font-body);
    font-size: 0.9rem;
    font-weight: 600;
    padding: 0.75rem 0;
    border-radius: 8px;
    border: 2px solid var(--color-border);
    background: transparent;
    color: var(--color-dark);
    cursor: pointer;
    transition: border-color 0.2s;
  }
  .ofs-reset-btn:hover { border-color: var(--color-dark); }
  .ofs-nav-buttons {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    justify-content: flex-end;
  }
  .ofs-nav-btn {
    background: #F3F4F6;
    border: none;
    border-radius: 8px;
    padding: 0.4rem 0.85rem;
    cursor: pointer;
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--color-muted);
    font-family: var(--font-body);
    transition: background 0.15s;
  }
  .ofs-nav-btn:hover { background: #E5E7EB; }
  .ofs-step-indicators {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin-top: 1.5rem;
    padding-top: 1rem;
    border-top: 1px solid #F0F0F3;
  }
  .ofs-step-pill {
    font-size: 0.68rem;
    font-weight: 600;
    padding: 4px 12px;
    border-radius: 20px;
    letter-spacing: 0.02em;
    transition: all 0.3s ease;
  }
</style>

<script is:inline>
(function() {
  var STEPS = {
    start: {
      question: "Does the order include cabinets or oversized parts?",
      subtitle: "Wall cabinets, base cabinets, tall cabinets, or any other parts over 94\u2033 tall?",
      icon: "\uD83D\uDCD0", yes: "express_shipping", no: "outsourced_items"
    },
    express_shipping: {
      question: "Express shipping with 5-day production?",
      subtitle: "Does the customer need expedited 5-day production and express truck shipping?",
      icon: "\uD83D\uDE9A", yes: "result_express_truck", no: "result_standard_cabinet"
    },
    outsourced_items: {
      question: "Range hoods, custom vanities, or outsourced items?",
      subtitle: "Does the order include range hoods, custom vanities, or any items sourced from outside vendors?",
      icon: "\uD83C\uDFED", yes: "result_standard_outsourced", no: "custom_sample"
    },
    custom_sample: {
      question: "Custom sample face frame & door or SD12\u00BD\u00D715\u00BD?",
      subtitle: "Does the order include a Custom Sample Face Frame And Door, or an SD12\u00BD\u00D715\u00BD sample?",
      icon: "\uD83E\uDE9F", yes: "result_color_sample", no: "color_samples_qty"
    },
    color_samples_qty: {
      question: "More than three 8\u00BD \u00D7 11 color samples?",
      subtitle: "Does the order include more than 3 color sample chips at the 8\u00BD \u00D7 11 size?",
      icon: "\uD83C\uDFA8", yes: "result_standard_samples", no: "loose_doors"
    },
    loose_doors: {
      question: "Chargeable loose doors and/or drawer fronts?",
      subtitle: "Does the order include any chargeable loose door or drawer front components?",
      icon: "\uD83D\uDEAA", yes: "result_express_door", no: "result_express_parcel"
    },
    result_express_truck: {
      result: true, form: "Express Truck Order Form", part: "Express Truck",
      notes: "For cabinet orders with express 5-day production and truck shipping",
      color: "#B45309", icon: "\uD83D\uDE9A"
    },
    result_standard_cabinet: {
      result: true, form: "Standard Order Form", part: "Standard Lead Time",
      notes: "Cabinet or oversized parts \u2014 standard production timeline applies",
      color: "#2563EB", icon: "\uD83D\uDCCB"
    },
    result_standard_outsourced: {
      result: true, form: "Standard Order Form", part: "Standard Lead Time",
      notes: "Orders with range hoods, custom vanities, or outsourced items require standard lead time",
      color: "#2563EB", icon: "\uD83D\uDCCB"
    },
    result_color_sample: {
      result: true, form: "Color Sample Ordering Process", part: "See ordering steps",
      notes: "Follow the Color Sample Ordering Steps to process this type of sample request",
      color: "#7C3AED", icon: "\uD83D\uDCDD"
    },
    result_standard_samples: {
      result: true, form: "Standard Order Form", part: "Standard Lead Time",
      notes: "More than 3 color samples at 8\u00BD \u00D7 11 size \u2014 use standard order process",
      color: "#2563EB", icon: "\uD83D\uDCCB"
    },
    result_express_door: {
      result: true, form: "Express Door and Drawer Front Form", part: "Express Door/Drawer",
      notes: "For chargeable loose doors and drawer fronts with express processing",
      color: "#0B6E4F", icon: "\u26A1"
    },
    result_express_parcel: {
      result: true, form: "Express Parcel Order", part: "Express Parcel",
      notes: "Small express order \u2014 no cabinets, no outsourced items, 3 or fewer color samples, no loose doors",
      color: "#0B6E4F", icon: "\uD83D\uDCE6"
    }
  };

  var STEP_NODES = [
    { id: "start", label: "Cabinets?" },
    { id: "express_shipping", label: "Express?" },
    { id: "outsourced_items", label: "Outsourced?" },
    { id: "custom_sample", label: "Samples?" },
    { id: "color_samples_qty", label: "Qty > 3?" },
    { id: "loose_doors", label: "Loose doors?" }
  ];

  var currentStep = "start";
  var history = [];
  var container = document.getElementById("order-form-selector");
  var maxDepth = 5;

  function render() {
    var step = STEPS[currentStep];
    var isResult = step.result;
    var depth = history.length;
    var pct = isResult ? 100 : Math.min((depth / maxDepth) * 100, 95);
    var html = "";

    if (history.length > 0) {
      html += '<div class="ofs-nav-buttons">';
      html += '<button class="ofs-nav-btn" id="ofs-back">\u2190 Back</button>';
      html += '<button class="ofs-nav-btn" id="ofs-reset">Reset</button>';
      html += '</div>';
    }

    html += '<div class="ofs-progress-bar"><div class="ofs-progress-meta"><span>' +
      (isResult ? "Complete" : "Step " + (depth + 1)) + '</span><span>' +
      Math.round(pct) + '%</span></div><div class="ofs-progress-track"><div class="ofs-progress-fill' +
      (isResult ? ' complete' : '') + '" style="width:' + pct + '%"></div></div></div>';

    if (history.length > 0) {
      html += '<div class="ofs-breadcrumbs">';
      history.forEach(function(h, i) {
        html += '<span class="ofs-crumb"><span class="ofs-crumb-pill ' + h.answer + '">' + h.answer + '</span>';
        if (i < history.length - 1) html += '<span class="ofs-crumb-arrow">\u2192</span>';
        html += '</span>';
      });
      html += '</div>';
    }

    if (isResult) {
      html += '<div class="ofs-result-card" id="ofs-animate" style="background:linear-gradient(135deg,' +
        step.color + ',' + step.color + 'CC)">' +
        '<div class="ofs-result-badge">\u2713 Order Form Identified</div>' +
        '<div class="ofs-result-icon">' + step.icon + '</div>' +
        '<div class="ofs-result-form">' + step.form + '</div>' +
        '<div class="ofs-result-part">' + step.part + '</div>' +
        '<div class="ofs-result-notes">' + step.notes + '</div></div>';
      html += '<button class="ofs-reset-btn" id="ofs-new-lookup">Start New Lookup</button>';
    } else {
      html += '<div class="ofs-question-card" id="ofs-animate">' +
        '<div class="ofs-icon">' + step.icon + '</div>' +
        '<div class="ofs-question">' + step.question + '</div>' +
        '<div class="ofs-subtitle">' + step.subtitle + '</div>' +
        '<div class="ofs-buttons"><button class="ofs-btn ofs-btn-yes" id="ofs-yes">Yes</button>' +
        '<button class="ofs-btn ofs-btn-no" id="ofs-no">No</button></div></div>';
    }

    if (!isResult) {
      var visitedIds = { start: true };
      history.forEach(function(h) { visitedIds[h.nextStep] = true; });
      html += '<div class="ofs-step-indicators">';
      STEP_NODES.forEach(function(node) {
        var isCurrent = currentStep === node.id;
        var isVisited = visitedIds[node.id];
        var bg = isCurrent ? "#1A1D23" : isVisited ? "#FEF3C7" : "#F3F4F6";
        var color = isCurrent ? "#fff" : isVisited ? "#92400E" : "#9CA3AF";
        html += '<span class="ofs-step-pill" style="background:' + bg + ';color:' + color + '">' + node.label + '</span>';
      });
      html += '</div>';
    }

    container.innerHTML = html;

    requestAnimationFrame(function() {
      requestAnimationFrame(function() {
        var el = document.getElementById("ofs-animate");
        if (el) el.classList.add("visible");
      });
    });

    var yesBtn = document.getElementById("ofs-yes");
    var noBtn = document.getElementById("ofs-no");
    var backBtn = document.getElementById("ofs-back");
    var resetBtn = document.getElementById("ofs-reset");
    var newBtn = document.getElementById("ofs-new-lookup");
    if (yesBtn) yesBtn.addEventListener("click", function() { handleAnswer("yes"); });
    if (noBtn) noBtn.addEventListener("click", function() { handleAnswer("no"); });
    if (backBtn) backBtn.addEventListener("click", handleBack);
    if (resetBtn) resetBtn.addEventListener("click", handleReset);
    if (newBtn) newBtn.addEventListener("click", handleReset);
  }

  function handleAnswer(answer) {
    var step = STEPS[currentStep];
    var nextStep = step[answer];
    history.push({ step: currentStep, answer: answer, nextStep: nextStep });
    currentStep = nextStep;
    render();
  }

  function handleBack() {
    if (history.length === 0) return;
    var prev = history.pop();
    currentStep = prev.step;
    render();
  }

  function handleReset() {
    currentStep = "start";
    history = [];
    render();
  }

  render();
})();
</script>
